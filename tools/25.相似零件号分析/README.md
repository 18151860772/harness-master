# 相似零件号分析工具 - 使用说明

## 📁 文件说明

1. **similar_parts_analyzer.html** - 在线版（需要网络连接）
2. **similar_parts_analyzer_local.html** - 本地版（需要下载xlsx库）
3. **xlsx.full.min.js** - Excel处理库（需要单独下载）

## 🚀 快速开始

### 方案一：使用在线版（推荐，最简单）

1. 确保电脑已连接网络
2. 用浏览器打开 `similar_parts_analyzer.html`
3. 上传您的Master List Excel文件
4. 查看分析结果
5. 点击"导出分析结果"按钮下载Excel报告

**注意：** 如果遇到CDN加载失败，请使用方案二。

### 方案二：使用本地版（离线可用）

1. **下载 xlsx.full.min.js**
   - 访问：https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js
   - 右键点击页面内容 → 另存为
   - 保存为 `xlsx.full.min.js` 到本工具目录

2. **使用工具**
   - 用浏览器打开 `similar_parts_analyzer_local.html`
   - 上传您的Master List Excel文件
   - 查看分析结果并导出

## 📊 Excel文件格式要求

工具会分析Master List文件的**最后一个sheet**：

- **第3行**：配置描述（如：颜色、尺寸、材质等）
- **第4行**：包含ALL列，用于标识配置项的起始位置
- **第5行起**：零件数据
  - 第1列：零件号
  - 第2列：零件名称（中文）
  - ALL列之后的列：配置打点（● = 有此功能，空值 = 无此功能）

## 🔍 分析逻辑

1. 按零件名称（中文）分组
2. 为每个零件找同组内最相似的4个零件
3. 计算配置差异数量（从少到多排序）
4. 列出具体的配置差异项

## 💡 使用示例

Excel文件结构示例：

```
第1行: （标题行，任意内容）
第2行: （标题行，任意内容）
第3行: 零件号    零件名称    颜色    材质    尺寸    重量
第4行: （任意）  （任意）    ALL     ALL     ALL     ALL
第5行: A001      螺丝        ●       ●       ○
第6行: A002      螺丝        ●       ○       ○
第7行: A003      螺丝        ○       ●       ●
```

说明：
- 第3行是配置描述
- 第4行的ALL标识从哪一列开始是配置项
- 第5行起是零件数据，●表示有此配置，空值或○表示无此配置

分析结果：
- A001 最相似的是 A002（差异1项：材质）
- A001 其次相似的是 A003（差异2项：颜色、尺寸）

## ❓ 常见问题

### Q1: 提示"XLSX库未加载完成"？

**解决方法：**
1. 刷新页面重试
2. 检查网络连接
3. 使用本地版（方案二）

### Q2: 提示"未找到ALL列"？

**解决方法：**
- 确保Excel第4行有"ALL"标记
- ALL列应该出现在需要分析的配置列的上方
- ALL列之后的列将被作为配置项进行分析

### Q3: 分析结果不准确？

**检查事项：**
- 确认配置打点使用的是 ● 符号
- 确认零件名称在同一列
- 确认数据从第5行开始

### Q4: 无法拖拽上传文件？

**解决方法：**
- 点击"选择Master List文件"按钮上传
- 更新浏览器到最新版本

## 📝 导出结果说明

导出的Excel文件包含以下列：

- **目标零件号**：分析的基准零件
- **零件名称**：零件中文名称
- **相似度排名**：1-4位，1表示最相似
- **相似零件号**：相似零件的零件号
- **差异配置数**：有多少项配置不同
- **配置差异详情**：具体差异描述（如：颜色(目标:有,对比:无)）

## 🔧 技术支持

如有问题，请检查：
1. 浏览器版本（建议使用Chrome、Edge最新版）
2. Excel文件格式（.xlsx或.xls）
3. 文件大小（建议小于50MB）
4. 数据格式是否符合要求

---

**版本信息：** v1.0
**最后更新：** 2025-01-19
