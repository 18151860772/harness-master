# Master List 自动化生成工具 - 测试说明

## 测试环境

- 浏览器：Chrome、Edge、Firefox等现代浏览器
- 文件格式：.xlsx或.xls格式
- 测试文件：
  - Wire List.xlsx（Wire List工作表）
  - 配置表.xlsx（Master List工作表）

## 测试步骤

### 1. 文件上传测试

**测试目标**：验证文件上传功能是否正常

**测试步骤**：
1. 打开 `masterlist-generator-new.html` 文件
2. 点击"上传 Wire List"区域，选择Wire List文件
3. 观察是否显示文件名和绿色对勾
4. 点击"上传配置表"区域，选择配置表文件
5. 观察是否显示文件名和绿色对勾
6. 检查"开始处理"按钮是否变为可用状态

**预期结果**：
- 两个文件都能成功上传
- 显示正确的文件名
- "开始处理"按钮变为可用状态

### 2. Option解析测试

**测试目标**：验证Option组合拆分功能是否正确

**测试数据**：
- `KP01&KB02&GXA` → 应拆分为 KP01、KB02、GXA
- `(LC02/LC20)` → 应拆分为 LC02、LC20
- `KP01&KB02&(LC02/LC20)&GXA` → 应拆分为 KP01、KB02、LC02、LC20、GXA
- `-S600` → 应保留为 -S600

**测试步骤**：
1. 上传包含上述Option组合的Wire List文件
2. 开始处理
3. 查看处理日志中的Option解析信息

**预期结果**：
- Option能够正确拆分
- 处理日志中显示正确的Option数量

### 3. Family分组测试

**测试目标**：验证Family分组功能是否正确

**测试步骤**：
1. 上传包含多个Family的Wire List文件
2. 开始处理
3. 查看统计数据中的Family总数
4. 查看结果表格中的Family列

**预期结果**：
- Family总数与Wire List中不同的Ident Tag数量一致
- 所有Family都正确显示在结果表格中

### 4. 版型匹配测试

**测试目标**：验证版型打点匹配功能是否正确

**测试步骤**：
1. 上传Wire List和配置表文件
2. 开始处理
3. 查看结果表格中的版型列
4. 检查打点情况是否与配置表一致

**预期结果**：
- 版型列正确显示所有版型
- 打点情况与配置表中的打点关系一致

### 5. Option组合汇总测试

**测试目标**：验证相同Family的相同Option组合汇总功能是否正确

**测试步骤**：
1. 上传Wire List和配置表文件
2. 开始处理
3. 查看结果表格
4. 检查相同Family的相同Option组合是否汇总到一行

**预期结果**：
- 相同Family的相同Option组合汇总到一行
- 不同版型的打点情况在同一行中显示

### 6. 筛选功能测试

**测试目标**：验证筛选功能是否正常

**测试步骤**：
1. 处理完成后，在Family筛选框中输入关键字
2. 观察表格是否实时筛选
3. 在版型筛选框中选择特定版型
4. 观察表格是否只显示在该版型中打点的Family

**预期结果**：
- Family筛选能够正确筛选表格
- 版型筛选能够正确筛选表格
- 筛选结果准确无误

### 7. 导出功能测试

**测试目标**：验证导出功能是否正常

**测试步骤**：
1. 处理完成后，点击"导出结果"按钮
2. 检查是否成功下载Excel文件
3. 打开导出的Excel文件
4. 检查文件格式是否与MasterList__202508060203859.xlsx一致

**预期结果**：
- 成功下载Excel文件
- 文件名格式正确（MasterList__YYYYMMDDHHMMSS.xlsx）
- 文件格式与MasterList__202508060203859.xlsx一致
- 数据完整无误

### 8. 性能测试

**测试目标**：验证工具处理大文件时的性能

**测试步骤**：
1. 上传包含大量数据的Wire List和配置表文件
2. 开始处理
3. 观察处理时间和内存占用

**预期结果**：
- 处理时间在可接受范围内
- 内存占用合理
- 不出现卡顿或崩溃

## 测试用例

### 用例1：基本功能测试

**输入**：
- Wire List：包含FLOOR、IP、DOOR等Family
- 配置表：包含多个版型

**预期输出**：
- 正确生成Master List
- 所有Family都正确显示
- 打点关系正确

### 用例2：复杂Option组合测试

**输入**：
- Wire List：包含复杂Option组合（如 `KP01&KB02&(LC02/LC20)&GXA`）
- 配置表：对应的打点关系

**预期输出**：
- Option正确拆分
- 打点关系正确

### 用例3：相同Family汇总测试

**输入**：
- Wire List：FLOOR Family在多个版型中有相同的Option组合
- 配置表：对应的打点关系

**预期输出**：
- 相同Option组合汇总到一行
- 多个版型的打点在同一行中显示

### 用例4：边界情况测试

**输入**：
- Wire List：包含空Option、负号Option等边界情况
- 配置表：对应的打点关系

**预期输出**：
- 正确处理边界情况
- 不出现错误或异常

## 常见问题排查

### 问题1：文件上传失败

**可能原因**：
- 文件格式不正确
- 文件损坏
- Sheet名称不正确

**解决方法**：
- 检查文件格式是否为.xlsx或.xls
- 检查文件是否损坏
- 检查Sheet名称是否为"Wire List"和"Master List"

### 问题2：处理失败

**可能原因**：
- 数据格式不正确
- 缺少必要的列
- 数据不完整

**解决方法**：
- 检查数据格式是否符合要求
- 检查是否包含所有必要的列
- 检查数据是否完整

### 问题3：导出失败

**可能原因**：
- 浏览器不支持下载
- 磁盘空间不足
- 文件过大

**解决方法**：
- 检查浏览器是否支持下载
- 检查磁盘空间是否充足
- 尝试分批处理数据

### 问题4：打点关系不正确

**可能原因**：
- 配置表数据不正确
- Option解析错误
- 版型匹配逻辑错误

**解决方法**：
- 检查配置表数据是否正确
- 检查Option解析是否正确
- 检查版型匹配逻辑是否正确

## 测试报告模板

### 测试日期：YYYY-MM-DD
### 测试人员：XXX
### 测试环境：XXX

| 测试项 | 测试结果 | 备注 |
|--------|----------|------|
| 文件上传测试 | 通过/失败 | |
| Option解析测试 | 通过/失败 | |
| Family分组测试 | 通过/失败 | |
| 版型匹配测试 | 通过/失败 | |
| Option组合汇总测试 | 通过/失败 | |
| 筛选功能测试 | 通过/失败 | |
| 导出功能测试 | 通过/失败 | |
| 性能测试 | 通过/失败 | |

### 总体评价：通过/失败

### 问题描述：XXX

### 改进建议：XXX
