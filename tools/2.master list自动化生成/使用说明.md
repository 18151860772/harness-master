# Master List 自动化生成工具 - 最终版使用说明

## 工具简介

本工具是一个基于网页的自动化工具，用于根据Wire List和配置表自动生成Master List。工具会根据Wire List中的Ident Tag涉及的Option组合，自动生成零件号（如FLOOR001、FLOOR002等），然后通过匹配配置表中的版型和特征值关系，生成完整的Master List打点结果。

## 核心功能

### 1. 按Option组合生成零件号
- 根据Wire List中每个Ident Tag涉及的Option
- 自动识别不同的Option组合
- 为每种独特的Option组合生成一个零件号
- 格式：Ident Tag + 三位数字（如FLOOR001、FLOOR002、IP001等）

### 2. 智能Option解析
- 自动拆分组合Option（包含&、/、-、()等符号）
- 例如：`KP01&KB02&(LC02/LC20)&GXA` → 拆分为 KP01、KB02、LC02、LC20、GXA

### 3. 按Ident Tag分组
- 根据Wire List中的Ident Tag对数据进行分组
- 每个Ident Tag对应多个零件号（根据Option组合数量）
- 统计每个Ident Tag涉及的所有Option

### 4. 版型匹配打点
- 根据Wire List中每个Ident Tag涉及的Option组合
- 匹配配置表中各版型的打点情况
- 如果某个Option组合在某个版型中打点，则对应的零件号在该版型中打点

### 5. 完整的Master List格式
- 生成的格式与MasterList__202508060203859.xlsx一致
- 包含：No、零件号、各版型列、所有Option列
- 打点用●表示

## 生成逻辑说明

### Option组合识别

工具会分析每个Ident Tag涉及的所有Option，然后根据配置表中的版型打点情况，识别出不同的Option组合。

**示例：FLOOR Ident Tag**

假设FLOOR涉及以下Option：EP01, KG01, KQ00, KB02, ALL, JL04, RJ01, KP02, LHD, FW98...

工具会检查每个版型中哪些Option打点，然后识别出独特的Option组合：

- **FLOOR001**：Option组合A（如EP01, KG01, KQ00, KB02）→ 在17个版型中打点
- **FLOOR002**：Option组合B（如EP01, KQ00, KB02, ALL, JL04）→ 在17个版型中打点
- **FLOOR003**：Option组合C（如EP01, KG01, KB02, ALL, JL04）→ 在16个版型中打点
- ...

每个独特的Option组合会生成一个独立的零件号。

### 零件号生成规则

1. **清理Ident Tag**：移除空格，转换为大写
2. **识别Option组合**：根据版型打点情况识别不同的Option组合
3. **格式化编号**：Ident Tag + 三位数字（如FLOOR001）
4. **排序编号**：按Option组合顺序编号

## 使用步骤

### 1. 打开工具

双击打开 `masterlist-generator-final.html` 文件，在浏览器中运行。

### 2. 上传文件

工具提供两个文件上传区域：

- **Wire List上传区**：点击或拖拽上传Wire List文件（.xlsx或.xls格式）
- **配置表上传区**：点击或拖拽上传配置表文件（.xlsx或.xls格式）

上传成功后，会显示文件名和绿色对勾标记。

### 3. 开始处理

两个文件都上传完成后，"开始处理"按钮将变为可用状态。点击该按钮开始处理数据。

处理过程中会显示进度条和处理状态，包括：
- 解析Wire List
- 解析配置表
- 分析Wire List数据
- 生成Option组合
- 匹配版型打点
- 生成结果表格

### 4. 查看结果

处理完成后，会显示以下信息：

#### 统计数据
- 零件号总数：根据Option组合生成的零件号数量
- 版型总数：配置表中版型的数量
- Option总数：从Wire List中解析出的Option总数
- 打点总数：所有零件号在所有版型中的打点总数
- Ident Tag总数：Wire List中Ident Tag的数量

#### 结果表格
表格包含以下列：
- **No**：零件号序号
- **零件号**：根据Ident Tag和Option组合生成的零件号（如FLOOR001、IP001等）
- **各版型列**：显示每个零件号在各版型中的打点情况（●表示打点）
- **各Option列**：显示每个零件号涉及哪些Option（●表示涉及）

#### 筛选功能
- **零件号筛选**：输入零件号关键字，实时筛选表格
- **Ident Tag筛选**：选择特定的Ident Tag，只显示该Tag对应的零件号

#### 处理日志
显示处理过程中的详细日志信息，包括：
- 文件加载状态
- 数据解析进度
- Option组合生成情况
- 匹配结果统计
- 错误和警告信息

### 5. 导出结果

点击"导出结果"按钮，将处理结果导出为Excel文件。导出的文件：
- 文件名格式：`MasterList__YYYYMMDDHHMMSS.xlsx`
- 包含完整的Master List表格
- 格式与MasterList__202508060203859.xlsx一致

## 数据格式要求

### Wire List格式

Wire List文件应包含以下列：
- Wire ID：线束编号
- Color：颜色
- Size / Gauge：线径
- Material：材质
- Option：配置选项（支持组合Option）
- Multicore ID：多芯线编号
- Ident Tag：识别标签（用于生成零件号）
- From：起点
- To：终点

### 配置表格式

配置表文件应包含以下结构：
- 第1行：空行
- 第2行：版型名称（从第4列开始）
- 第3行及以后：Family数据
  - 第1列：Family编号（对应Wire List中的Option）
  - 第2列：Family名称
  - 第3列：备注
  - 第4列及以后：各版型的打点情况（●或其他标记表示打点）

## Option解析规则

工具支持以下Option组合格式：

1. **&连接**：`KP01&KB02&GXA` → 拆分为 KP01、KB02、GXA
2. **括号内/连接**：`(LC02/LC20)` → 拆分为 LC02、LC20
3. **负号开头**：`-S600` → 保留为 -S600
4. **组合使用**：`KP01&KB02&(LC02/LC20)&GXA` → 拆分为 KP01、KB02、LC02、LC20、GXA
5. **负号组合**：`-(NN11&KP01)` → 拆分为 -(NN11&KP01)（作为整体）

## 版型匹配逻辑

工具会为每种Option组合生成一个零件号，并匹配版型打点：

1. **提取Ident Tag涉及的Option**：从Wire List中提取该Ident Tag涉及的所有Option
2. **遍历所有版型**：对每个版型，检查哪些Option在该版型中打点
3. **识别Option组合**：识别出独特的Option组合
4. **生成零件号**：为每种独特的Option组合生成一个零件号
5. **匹配版型打点**：如果某个Option组合在某个版型中打点，则对应的零件号在该版型中打点

## 注意事项

1. **文件格式**：确保上传的文件是.xlsx或.xls格式
2. **Sheet名称**：Wire List的Sheet名称应为"Wire List"，配置表的Sheet名称应为"Master List"
3. **数据完整性**：确保Wire List和配置表的数据完整且格式正确
4. **Ident Tag一致性**：确保Wire List中的Ident Tag格式统一
5. **浏览器兼容性**：建议使用Chrome、Edge或Firefox等现代浏览器
6. **文件大小**：大文件处理可能需要较长时间，请耐心等待

## 常见问题

### Q: 上传文件后没有反应？
A: 请检查文件格式是否正确（.xlsx或.xls），并确保文件没有损坏。

### Q: 处理过程中出现错误？
A: 请查看处理日志中的错误信息，检查数据格式是否符合要求。

### Q: 导出的结果不完整？
A: 请检查原始数据是否完整，特别是Ident Tag和Option列是否有空值。

### Q: 筛选功能没有效果？
A: 请确保输入的零件号或选择的Ident Tag正确，区分大小写。

### Q: 零件号生成不符合预期？
A: 请检查Wire List中的Ident Tag格式和Option组合，工具会根据Option组合自动生成零件号。

### Q: 为什么同一个Ident Tag有多个零件号？
A: 因为同一个Ident Tag可能有多种不同的Option组合，每种独特的Option组合会生成一个独立的零件号。例如，FLOOR可能有FLOOR001、FLOOR002、FLOOR003等多个零件号，每个对应不同的Option组合。

## 输出格式说明

生成的Master List文件格式与MasterList__202508060203859.xlsx一致：

### 表头
- **No**：零件号序号
- **零件号**：根据Ident Tag和Option组合生成的零件号
- **版型列**：配置表中的所有版型（如T28F4J20+840AHA...等）
- **Option列**：Wire List中涉及的所有Option（如EP01、QR02、KG01等）

### 数据行
- 每行代表一个零件号
- 版型列中●表示该零件号在该版型中打点
- Option列中●表示该零件号涉及该Option

## 技术支持

如遇到问题或需要帮助，请查看处理日志中的详细信息，或联系技术支持。

## 更新日志

### 最终版 (2025-01-03)
- **核心功能改进**：根据Option组合生成零件号并匹配车型
- **新增**：自动识别不同的Option组合
- **新增**：为每种独特的Option组合生成独立的零件号
- **优化**：版型匹配逻辑，确保每个零件号正确匹配对应的车型
- **优化**：生成格式完全符合MasterList__202508060203859.xlsx
- **新增**：详细的Option组合分析日志
- **优化**：改进用户界面和交互体验

### V3.0 (2025-01-03)
- 新增：根据Ident Tag自动生成零件号功能
- 新增：零件号格式为Ident Tag + 三位数字（如FLOOR001）
- 新增：按Ident Tag排序并自动编号
- 优化：匹配MasterList__202508060203859.xlsx的格式
- 新增：完整的版型和Option打点展示
- 优化：改进用户界面和交互体验

### V2.0 (2025-01-03)
- 新增Ident Tag筛选功能
- 新增Family编号筛选功能
- 优化Option解析逻辑
- 改进用户界面
- 添加详细的处理日志
- 支持大文件处理

### V1.0 (2025-01-03)
- 初始版本发布
- 支持Wire List和配置表上传
- 实现Option解析和拆分
- 实现Family匹配和打点
- 支持结果导出
