# Wire List 与配置表数据对比分析报告

## 执行时间
2026-01-04

## 一、文件结构分析

### 1.1 Wire List 文件
- **文件路径**: `Wire list.xlsx`
- **数据规模**: 6049行 × 11列
- **列结构**:
  1. Wire ID - 线束ID
  2. Color - 颜色
  3. Size / Gauge - 尺寸/线规
  4. Material - 材料
  5. **Option** - 选项（关键列）
  6. Multicore ID - 多芯ID
  7. **Ident Tag** - 标识标签
  8. From - 起点
  9. From.1 - 起点.1
  10. To - 终点
  11. To.1 - 终点.1

### 1.2 配置表文件
- **文件路径**: `配置表.xlsx`
- **数据规模**: 840行 × 63列
- **A列（特征值代码）**: 包含838个唯一值
- **列结构**: 
  - A列: 特征值代码（如JW12, JY00, KG01, KP01等）
  - B列: 特征值描述
  - C列: 备注
  - D列及以后: 各车型配置（60个不同车型/配置组合）

## 二、关键列数据分析

### 2.1 Wire List Option 列
- **唯一值数量**: 1044个
- **数据特征**: 
  - Option列的值是**组合值**，多个特征值代码用`&`符号连接
  - 示例: `QR02&KG01&KQ00&-S600`, `KP01&FV16&-V801`, `ALL`, `LHD`, `RHD`
  - 包含否定符号`-`表示排除某个特征
  - 包含特殊值如`ALL`, `LHD`, `RHD`（左舵/右舵）

### 2.2 Wire List Ident Tag 列
- **唯一值数量**: 24个
- **数据特征**: 
  - 表示线束所在的物理位置/区域
  - 示例: `FLOOR`, `IP`, `ENGINE`, `LIFTGATE LH`, `FR DOOR`等

### 2.3 配置表A列（特征值代码）
- **唯一值数量**: 838个
- **数据特征**: 
  - 标准的4位字母数字代码
  - 示例: `JW12`, `JY00`, `KG01`, `KP01`, `FR61`, `FV16`等
  - 代表不同的配置特征（如车型、动力总成、配置等级等）

## 三、数据对比分析

### 3.1 配置表A列 vs Wire List Option 列
- **匹配率**: 11.81% (99/838)
- **匹配方式**: 直接字符串匹配
- **匹配的特征值代码**: 
  `KG01, KG04, KP01, KP02, FR61, FR43, FW98, FW95, FV16, FV09, FV06, FV11, KQ00, KQ03, AS01, AS04, B201, BH03, BH04, BH05, BH12, BJ06, UN00, DX01, QR02, LF01, EC00, ED00, EF00, EE00, UV00, HK06, JG03, JS00, ER00, AH00, AJ00, AJ01, B100, B103, EP01, GF00, S000, NM03, LW00, VA02, P600, QK00, FA00, JV02, F502, CK03, CX00, HN03, HT02, MC00, MC01, HV11, 0H00, PJ06, UJ01, RX00, SN00, GK01, FX00, PC01, DH02, SA00, RP00, RP01, EM00, HC00, QJ00, QJ02, PD00, YC00, TT00, TH00, L300, L600, JL03, JL04, JJ00, RU00, RJ00, RJ01, M206, TJ00, G700, RQ02, HL00, UK00, C600, S600, HD00, TP00, 1S00, LHD, RHD`

### 3.2 配置表A列 vs Wire List Ident Tag 列
- **匹配率**: 0.00% (0/838)
- **结论**: 配置表A列与Ident Tag列没有任何直接对应关系

### 3.3 所有列匹配情况排序
| 列名 | 匹配数量 | 匹配率 | 说明 |
|------|---------|--------|------|
| Option | 99/838 | 11.81% | 最匹配的列 |
| Wire ID | 9/838 | 1.07% | 偶然匹配 |
| Multicore ID | 3/838 | 0.36% | 偶然匹配 |

## 四、关键发现

### 4.1 Option列的数据结构
Option列的值是**复合表达式**，包含：
1. **多个特征值代码的组合**: 用`&`连接
   - 示例: `KG01&KP01&FV16` 表示同时满足KG01、KP01、FV16
2. **逻辑运算符**:
   - `&`: AND逻辑（同时满足）
   - `/`: OR逻辑（任一满足）
   - `-`: NOT逻辑（排除）
   - `()`: 分组
3. **特殊值**:
   - `ALL`: 所有配置
   - `LHD`: 左舵
   - `RHD`: 右舵

### 4.2 匹配率低的原因
虽然Option列包含配置表A列的特征值代码，但直接匹配率只有11.81%，原因是：

1. **Option列是组合值**: 
   - 配置表A列的值（如`KG01`）是Option列值的**组成部分**
   - 例如: `QR02&KG01&KQ00&-S600` 包含 `KG01`
   - 但完整字符串不等于 `KG01`

2. **需要解析Option列**:
   - 应该将Option列的值按`&`、`/`等分隔符拆分
   - 然后检查拆分后的每个部分是否匹配配置表A列的值

## 五、结论与建议

### 5.1 关键问题答案

**问题**: familyMap的key（配置表A列）应该对应Wire List的哪一列？

**答案**: 配置表A列（特征值代码）应该对应Wire List的 **Option列**，但需要进行特殊处理：

1. **不是直接对应**: 不能直接将Option列的完整值与配置表A列匹配
2. **需要解析**: 需要将Option列的复合表达式拆分成单独的特征值代码
3. **对应关系**: 
   - 配置表A列的每个值（如`KG01`）对应Option列中拆分出的一个特征值代码
   - 一个Option列的值可能包含多个配置表A列的值

### 5.2 数据对应关系示意图

```
配置表A列（特征值代码）          Wire List Option列
─────────────────────          ─────────────────────
KG01              ──┐
KP01              ──┼──> "QR02&KG01&KQ00&-S600"
KQ00              ──┘
FR61              ─────> "FR61&FV16"
FV16              ─────┘
LHD               ─────> "LHD"
RHD               ─────> "RHD"
```

### 5.3 实现建议

在实现familyMap时，应该：

1. **读取配置表A列**: 获取所有特征值代码
2. **解析Wire List Option列**: 
   - 将Option列的值按`&`、`/`等分隔符拆分
   - 去除否定符号`-`
   - 提取纯特征值代码
3. **建立映射关系**:
   - familyMap的key = 配置表A列的特征值代码
   - familyMap的value = 包含该特征值代码的Wire List行

### 5.4 示例代码逻辑

```javascript
// 假设的familyMap构建逻辑
const familyMap = {};

// 遍历Wire List
wireList.forEach(row => {
    // 解析Option列
    const optionValue = row['Option'];
    const features = parseOption(optionValue); // 拆分成特征代码数组
    
    // 为每个特征代码建立映射
    features.forEach(feature => {
        if (!familyMap[feature]) {
            familyMap[feature] = [];
        }
        familyMap[feature].push(row);
    });
});

// parseOption函数示例
function parseOption(option) {
    // 按&分割
    const parts = option.split('&');
    // 提取特征代码（去除-符号）
    return parts
        .map(p => p.trim())
        .filter(p => p && !p.startsWith('-') && p !== 'ALL');
}
```

## 六、总结

1. **配置表A列**包含838个特征值代码
2. **Wire List Option列**包含1044个复合选项值
3. **对应关系**: 配置表A列的特征值代码是Option列复合值的组成部分
4. **匹配方式**: 需要解析Option列，提取其中的特征值代码
5. **familyMap**: key=配置表A列的特征值代码，value=包含该特征的Wire List行

**最终结论**: familyMap的key（配置表A列）应该对应Wire List的Option列，但需要通过解析Option列的复合表达式来建立映射关系，而不是直接匹配完整字符串。
