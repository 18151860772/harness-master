===============================================================================
        回路表检查工具 V8.0 - 版本说明
===============================================================================

【发布日期】2025年1月23日
【版本号】V8.0
【新增功能】Multicore ID重复检查

===============================================================================
                          新增功能
===============================================================================

【Multicore ID重复检查】（V8.0新增）

功能描述：
- 检查Wire List中Multicore ID（组名号）的重复情况
- 根据组名号前缀判断是否超过允许的回路数量
- 超标的Multicore ID列标记为橙色

检查规则：
1. **TW开头**：回路数量 > 2，标记橙色
2. **T开头**：回路数量 > 2，标记橙色
3. **ST开头**：回路数量 > 3，标记橙色
4. **C开头**：回路数量 > 4，标记橙色

检查逻辑：
1. 收集所有回路的Multicore ID
2. 按Multicore ID分组，统计每个组的回路数量
3. 判断前缀类型（TW、T、ST、C）
4. 根据前缀对应的限制判断是否超标
5. 超标的Multicore ID标记所有相关回路

导出功能：
- Wire List：在"问题原因"列显示详细Multicore ID信息
- 汇总表：新增"Multicore ID重复"分类
- 颜色标记：使用橙色（warning级别）

===============================================================================
                          功能列表
===============================================================================

本工具包含以下检查功能：

1. Family一致性检查（红色标记）
   - 检查From/To连接器的Family是否与Connlist匹配
   - 检查Family是否为空

2. 焊点颜色一致性检查（紫色标记）
   - 检查相同焊点的导线颜色是否一致

3. 焊点Family一致性检查（紫色标记）
   - 检查相同焊点的回路Family是否一致

4. Inline两侧一致性检查（黄色标记）
   - 检查Inline连接器两侧PIN的导线颜色、线径是否一致

5. 重孔检查（橙色标记）
   - 检查插件孔位是否有重复
   - 支持Option表达式规范化（& / - ()运算符）
   - 排除焊点（Pin=X），只检查插件

6. Multicore ID重复检查（橙色标记）- V8.0新增
   - 检查组名号的重复情况
   - 根据前缀判断数量限制
   - 超标标记橙色

===============================================================================
                          Multicore ID规则详解
===============================================================================

【前缀判断规则】

| 前缀 | 限制数量 | 说明 |
|------|---------|------|
| TW   | ≤ 2     | TW开头的组名号最多2个回路 |
| T    | ≤ 2     | T开头的组名号最多2个回路（不含TW） |
| ST   | ≤ 3     | ST开头的组名号最多3个回路 |
| C    | ≤ 4     | C开头的组名号最多4个回路 |

【判断优先级】

TW开头优先判断，避免被T规则重复检查：
- "TW123" → 匹配TW规则
- "T456"  → 匹配T规则
- "ST789" → 匹配ST规则
- "C012"  → 匹配C规则

【示例说明】

示例1：TW开头的Multicore ID
- Multicore ID: "TW001"
- 回路数量: 3
- 限制: 2
- 结果: ✗ 超标，标记橙色

示例2：ST开头的Multicore ID
- Multicore ID: "ST-ABC"
- 回路数量: 4
- 限制: 3
- 结果: ✗ 超标，标记橙色

示例3：C开头的Multicore ID
- Multicore ID: "C123"
- 回路数量: 3
- 限制: 4
- 结果: ✓ 正常，不标记

===============================================================================
                          技术亮点
===============================================================================

1. Option表达式解析器
   - 支持 &（与）、/（或）、-（非）、（）运算符
   - 运算符优先级：() > - > & > /
   - 表达式规范化，识别等效表达式

2. 智能前缀匹配
   - TW优先于T判断，避免重复
   - 不区分大小写（支持小写tw、t、st、c）
   - 精确匹配前缀，避免误判

3. 智能问题汇总
   - 自动生成2个Sheet的Excel文件
   - Sheet1: 完整Wire List（含问题标记和原因）
   - Sheet2: 问题汇总表（按问题类型分组）

4. 灵活的筛选功能
   - 可按问题类型筛选显示
   - 支持显示/隐藏无问题行
   - 实时统计显示数量

===============================================================================
                          版本历史
===============================================================================

V8.0 (2025-01-23)
- [新增] Multicore ID重复检查功能
- [新增] 统计卡片：Multicore ID重复
- [新增] 汇总表分类：Multicore ID重复
- [新增] 筛选选项：Multicore ID重复
- [优化] 导出Excel时显示Multicore ID问题原因
- [优化] 表格标记使用橙色（warning级别）

V7.0 (2025-01-23)
- [新增] 焊点Family一致性检查功能
- [新增] 统计卡片：焊点Family不一致
- [新增] 汇总表分类：焊点Family不一致
- [新增] 筛选选项：焊点Family不一致

V6.0 (2025-01-23)
- [优化] 界面优化：文件上传紧凑布局（单行4列）
- [优化] 全屏显示：表格支持横向滚动显示所有列
- [新增] 导出增强：Wire List增加"问题原因"列
- [修复] 重孔检查Option颜色标记问题
- [修复] 颜色标记与问题原因对齐问题

V5.0
- [新增] Option表达式规范化（支持&/-/()运算符）
- [修复] 重孔检查逻辑（排除焊点，只检查插件）
- [优化] 汇总表按重孔插件排序
- [新增] 汇总表增加"回路号"列

V4.0
- [新增] 焊点颜色一致性检查（紫色标记）
- [新增] 汇总表作为第2个Sheet导出

V3.0
- [新增] Family一致性检查
- [新增] 筛选功能（按问题类型筛选）

V2.0
- [新增] Inline两侧PIN导线线色线径一致性检查

V1.0
- [初始版本] 基础回路表检查功能

===============================================================================
                          使用说明
===============================================================================

快速开始：
1. 双击打开 index.html
2. 上传4个必需文件（Wire List、Connlist、配置表、Inline表）
3. 点击"开始检查"按钮
4. 查看检查结果和问题汇总
5. 导出Excel文件（含2个Sheet）

文件要求：
- Wire List：必需包含 From/To Code、From/To Pin、Ident Tag、Color、Circuit、Multicore ID列
- Connlist：必需包含 Code、Family（短号）列
- 配置表：用于重孔检查的配置信息
- Inline表：用于Inline两侧检查

颜色标记：
- 红色：Family不一致/为空
- 紫色：焊点颜色不一致、焊点Family不一致
- 黄色：Inline两侧Color/Size不一致
- 橙色：重孔问题、Multicore ID重复

===============================================================================
                          问题排查
===============================================================================

Q: 为什么没有检测到Multicore ID重复？
A: 请确认：
   - Wire List中包含"Multicore ID"或"组名号"列
   - Multicore ID值以TW、T、ST或C开头（不区分大小写）
   - 同一Multicore ID确实存在超过限制数量的回路

Q: 橙色标记表示什么？
A: 橙色标记表示两类问题：
   1. 重孔问题（插件孔位重复）
   2. Multicore ID重复（组名号数量超标）

Q: 如何区分重孔和Multicore ID问题？
A: 查看单元格的"问题原因"列：
   - 重孔问题：显示"重孔: [插件]/[孔位]"
   - Multicore ID重复：显示"Multicore ID重复: [组名号] ([前缀]开头) 有 X 个回路，超过限制 Y"

Q: TW开头和T开头有什么区别？
A:
   - TW开头：优先匹配，限制2个回路
   - T开头：限制2个回路，不包含TW开头的组名号
   - 例如："TW001"只匹配TW规则，不匹配T规则

===============================================================================
                          技术支持
===============================================================================

如有问题或建议，请联系开发团队。

===============================================================================
                        感谢使用回路表检查工具！
===============================================================================
