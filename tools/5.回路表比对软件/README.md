# 回路表比对工具

这是一个基于Web的Excel表格比对工具，用于比较两个版本的回路表，识别新增、删除和变更的记录。

## 功能特性

### 核心功能
- **文件上传**：支持上传两个Excel文件（.xlsx或.xls格式）
- **自动比对**：自动识别表格中的差异
- **差异标记**：用不同颜色标记新增、删除和变更的记录
- **详细统计**：显示新增、删除、变更和未变更的记录数量
- **结果导出**：可以将比对结果导出为Excel文件

### 与VBS脚本对应的功能
- ✅ 以第2列（线号/导线号）为键值进行比对
- ✅ 从第4行开始读取数据（前3行为表头）
- ✅ 识别新增的记录（绿色标记）
- ✅ 识别删除的记录（灰色标记）
- ✅ 识别变更的记录（黄色标记）
- ✅ 标注具体变更内容（从X改为Y）
- ✅ 检查重复线号
- ✅ 自动添加当前日期标记

## 使用方法

### 基本操作
1. **上传旧表格**：点击"上传旧表格 (OLD)"区域，选择之前的版本
2. **上传新表格**：点击"上传新表格 (NEW)"区域，选择当前的版本
3. **开始比对**：点击"开始比对"按钮
4. **查看结果**：系统会显示详细的比对结果和统计信息
5. **导出结果**（可选）：点击"导出结果"按钮下载比对结果
6. **重新上传**：点击"重新上传"按钮开始新的比对

### 数据格式要求
- 表格必须至少有4行数据（3行表头 + 数据行）
- 第2列必须是唯一的线号/导线号，用作比对的键值
- 不能有重复的线号

### 颜色说明
- 🟢 **绿色**：新增的记录（只在新表格中存在）
- ⚫ **灰色**：删除的记录（只在旧表格中存在）
- 🟡 **黄色**：变更的记录（两个表格中都存在，但内容有差异）
- ⚪ **无色**：未变更的记录（两个表格中内容完全相同）

## 技术说明

### 技术栈
- **前端**：纯HTML5 + CSS3 + JavaScript
- **Excel处理**：SheetJS (xlsx)库
- **设计**：响应式布局，支持移动端

### 浏览器兼容性
- Chrome/Edge 90+
- Firefox 88+
- Safari 14+
- Opera 76+

### 数据安全
- 所有文件处理都在浏览器本地完成
- 不会上传任何数据到服务器
- 比对结果仅保存在本地

## 文件结构

```
回路表比对软件/
├── index.html              # 主网页文件
├── Comparing Tool.vbs      # 原始VBS脚本（参考）
├── README.md              # 说明文档
└── 比对/                  # 示例数据文件夹
    ├── NEW.xlsx           # 新表格示例
    └── OLD.xlsx           # 旧表格示例
```

## 注意事项

1. **文件格式**：仅支持.xlsx和.xls格式的Excel文件
2. **数据完整性**：确保两个表格的列数一致，以获得最佳比对效果
3. **重复数据**：如果表格中有重复的线号，会显示错误提示
4. **表头行数**：默认前3行为表头，从第4行开始读取数据

## 常见问题

**Q: 为什么比对按钮无法点击？**
A: 请确保已同时上传两个文件（旧表格和新表格）。

**Q: 支持哪些Excel格式？**
A: 支持.xlsx和.xls格式的文件。

**Q: 数据会被上传到服务器吗？**
A: 不会。所有文件处理都在您的浏览器本地完成，数据安全。

**Q: 如何导出比对结果？**
A: 比对完成后，点击"导出结果"按钮即可下载Excel格式的比对结果。

## 版本信息

- **版本**：1.0.0
- **发布日期**：2026年1月5日
- **开发者**：基于Comparing Tool.vbs的Web版本

## 许可证

本工具可自由使用和分发。
