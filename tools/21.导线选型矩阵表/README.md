# 导线选型矩阵表 - 使用说明

## 文件说明

- **web.html**: 主网页文件
- **converter.py**: Excel数据转换脚本（将数据嵌入到HTML中）
- **导线选型矩阵表V8.1.xlsx**: 默认Excel数据源
- **转换数据.bat**: 一键转换Excel数据到网页
- **启动网页.bat**: 在浏览器中打开网页

## 使用步骤

### 方式一：使用默认数据（推荐）

1. 双击运行 `转换数据.bat`（将Excel数据嵌入到web.html）
2. 双击运行 `启动网页.bat` 或直接在浏览器中打开 `web.html`

**注意**: 由于浏览器安全限制（CORS），现在采用数据嵌入方式，不再需要 data.json 文件。转换后的数据直接包含在 web.html 中，可以双击直接打开。

### 方式二：上传新文件

直接在浏览器中打开 `web.html`，然后点击"上传新的Excel文件"按钮选择你的Excel文件。

## 功能说明

### 第一个Sheet筛选
- **电源类型筛选**: 从首行识别电源相关列，筛选后会高亮显示对应列
- **线径筛选**: 根据B列（第2列）的线径值进行过滤

### 第二个Sheet筛选
- **功能筛选**: 根据首列（A列）的功能值进行过滤

## 技术要求

- 需要安装 Python 3.x
- 需要安装依赖库：pandas, openpyxl

如果Python未安装或缺少库，请先安装：
```
pip install pandas openpyxl
```

或者：
```
python -m pip install pandas openpyxl
```

## 问题排查

### 运行"转换数据.bat"时提示找不到模块
需要先安装 Python 依赖库：
```bash
pip install pandas openpyxl
```

### 网页打开后没有数据
1. 确认已经运行过 `转换数据.bat`
2. 检查是否有 "已加载预置数据" 的控制台提示（按F12打开控制台）

## 注意事项

- 默认使用本地Excel文件作为数据源
- 每次修改Excel后需要重新运行 `转换数据.bat`
- 上传新文件后会覆盖默认数据
- 点击"重置筛选"可恢复全部数据
